import{a as R,b as k,c as S}from"/build/_shared/chunk-4UNU5TGX.js";import{a as L,f as m,j as f,l as o,t as v,u as g,x as y}from"/build/_shared/chunk-G7BGYXZV.js";import{d as p}from"/build/_shared/chunk-G5WX4PPA.js";var u=p(L());var e=p(y()),N=[{type:"queries",items:[]},{type:"products",items:[]},{type:"collections",items:[]},{type:"pages",items:[]},{type:"articles",items:[]}];function G({searchTerm:s}){let t=(0,u.useRef)(null);return(0,u.useEffect)(()=>{function n(r){r.key==="k"&&r.metaKey&&(r.preventDefault(),t.current?.focus()),r.key==="Escape"&&t.current?.blur()}return document.addEventListener("keydown",n),()=>{document.removeEventListener("keydown",n)}},[]),(0,e.jsxs)(f,{method:"get",children:[(0,e.jsx)("input",{defaultValue:s,name:"q",placeholder:"Search\u2026",ref:t,type:"search"}),"\xA0",(0,e.jsx)("button",{type:"submit",children:"Search from custom"})]})}function U({results:s}){if(!s)return null;let t=Object.keys(s);return console.log(s),(0,e.jsx)("div",{children:s&&t.map(n=>{let r=s[n];if(r.nodes[0]?.__typename==="Page"){let c=r;return r.nodes.length?(0,e.jsx)(E,{pages:c},"pages"):null}if(r.nodes[0]?.__typename==="Product"){let c=r;return r.nodes.length?(0,e.jsx)(q,{products:c},"products"):null}if(r.nodes[0]?.__typename==="Article"){let c=r;return r.nodes.length?(0,e.jsx)(_,{articles:c},"articles"):null}return null})})}function q({products:s}){return(0,e.jsxs)("div",{className:"search-result",children:[(0,e.jsx)("h3",{children:"Products"}),(0,e.jsx)(S,{connection:s,children:({nodes:t,isLoading:n,NextLink:r,PreviousLink:c})=>{let i=t.map(a=>(0,e.jsx)("div",{className:"search-results-item",children:(0,e.jsx)(o,{prefetch:"intent",to:`/products/${a.handle}`,children:(0,e.jsx)("span",{children:a.title})})},a.id));return(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{children:(0,e.jsx)(c,{children:n?"Loading...":(0,e.jsx)("span",{children:"\u2191 Load previous"})})}),(0,e.jsxs)("div",{children:[i,(0,e.jsx)("br",{})]}),(0,e.jsx)("div",{children:(0,e.jsx)(r,{children:n?"Loading...":(0,e.jsx)("span",{children:"Load more \u2193"})})})]})}}),(0,e.jsx)("br",{})]})}function E({pages:s}){return(0,e.jsxs)("div",{className:"search-result",children:[(0,e.jsx)("h2",{children:"Pages"}),(0,e.jsx)("div",{children:s?.nodes?.map(t=>(0,e.jsx)("div",{className:"search-results-item",children:(0,e.jsx)(o,{prefetch:"intent",to:`/pages/${t.handle}`,children:t.title})},t.id))}),(0,e.jsx)("br",{})]})}function _({articles:s}){return(0,e.jsxs)("div",{className:"search-result",children:[(0,e.jsx)("h2",{children:"Articles"}),(0,e.jsx)("div",{children:s?.nodes?.map(t=>(0,e.jsx)("div",{className:"search-results-item",children:(0,e.jsx)(o,{prefetch:"intent",to:`/blog/${t.handle}`,children:t.title})},t.id))}),(0,e.jsx)("br",{})]})}function M(){return(0,e.jsx)("p",{children:"No results, try a different search."})}function V({action:s,children:t,className:n="predictive-search-form",method:r="POST",...c}){let i=m(),a=g(),l=(0,u.useRef)(null);function P(d){let h=s??"/api/predictive-search",T=i.locale?`/${i.locale}${h}`:h,b=d.target.value||"";a.submit({q:b,limit:"6"},{method:r,action:T})}return(0,u.useEffect)(()=>{l?.current?.setAttribute("type","search")},[]),(0,e.jsx)(a.Form,{...c,className:n,onSubmit:d=>{d.preventDefault(),d.stopPropagation(),!(!l?.current||l.current.value==="")&&l.current.blur()},children:t({fetchResults:P,inputRef:l,fetcher:a})})}function H(){let{results:s,totalResults:t,searchInputRef:n,searchTerm:r}=F();function c(i){n.current&&(n.current.blur(),n.current.value="",window.location.href=i.currentTarget.href)}return t?(0,e.jsxs)("div",{className:"predictive-search-results w-[270px] lg:w-[470px] absolute",children:[(0,e.jsx)("div",{children:s.map(({type:i,items:a})=>(0,e.jsx)(x,{goToSearchResult:c,items:a,searchTerm:r,type:i},i))}),r.current&&(0,e.jsx)(o,{onClick:c,to:`/search?q=${r.current}`,children:(0,e.jsxs)("p",{children:["View all results for ",(0,e.jsx)("q",{children:r.current}),"\xA0 \u2192"]})})]}):(0,e.jsx)(w,{searchTerm:r})}function w({searchTerm:s}){return s.current?(0,e.jsxs)("p",{children:["No results found for ",(0,e.jsx)("q",{children:s.current})]}):null}function x({goToSearchResult:s,items:t,searchTerm:n,type:r}){let c=r==="queries",i=`/search?q=${n.current}&type=${I(r)}`;return(0,e.jsx)("div",{className:"predictive-search-result",children:(0,e.jsx)("ul",{children:t.map(a=>(0,e.jsx)(A,{goToSearchResult:s,item:a},a.id))})},r)}function A({goToSearchResult:s,item:t}){return(0,e.jsx)("li",{className:"predictive-search-result-item",children:(0,e.jsxs)(o,{onClick:s,to:t.url,children:[t.image?.url&&(0,e.jsx)(k,{alt:t.image.altText??"",src:t.image.url,width:50,height:50}),(0,e.jsxs)("div",{children:[t.styledTitle?(0,e.jsx)("div",{dangerouslySetInnerHTML:{__html:t.styledTitle}}):(0,e.jsx)("span",{children:t.title}),t?.price&&(0,e.jsx)("small",{children:(0,e.jsx)(R,{data:t.price})})]})]})},t.id)}function F(){let s=v(),t=(0,u.useRef)(""),n=(0,u.useRef)(null),r=s.find(i=>i.data?.searchResults);r?.state==="loading"&&(t.current=r.formData?.get("q")||"");let c=r?.data?.searchResults||{results:N,totalResults:0};return(0,u.useEffect)(()=>{n.current||(n.current=document.querySelector('input[type="search"]'))},[]),{...c,searchInputRef:n,searchTerm:t}}function I(s){let t={articles:"ARTICLE",collections:"COLLECTION",pages:"PAGE",products:"PRODUCT",queries:"QUERY"};return typeof s=="string"?t[s]:s.map(n=>t[n]).join(",")}export{G as a,U as b,M as c,V as d,H as e};
